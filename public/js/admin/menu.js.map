{"version":3,"sources":["menu.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"menu.js","sourcesContent":["jQuery(function($){\n\tvar objects = new Array()\n\tvar menu = new Array()\n\n\t$('.connectedSortable').sortable({\n\t\tconnectWith: \".connectedSortable\"\n\t});\n\n\t$('#deleteZone').droppable({\n\t\taccept: \".connectedSortable > li\",\n\t\tactiveClass: \"ui-state-highlight\",\n\t\tdrop: function( event, ui ) {\n\t\t\tif (ui.draggable.length) {\n\t\t\t\t$(ui.draggable[0]).remove()\n\t\t\t}\n\t\t}\n\t});\n\n\t$('.ui-state-default').droppable({\n\t\tdrop : function( event, ui) {\n\t\t\t$('li.ui-state-default').css('border', '0px');\n\t\t},\n\t\tover : function( event, ui){\n\t\t\tthis.style.border = \"1px dashed black\"\n\t\t},\n\t\tout : function(){\n\t\t\tthis.style.border = \"0px\"\n\t\t}\n \t});\n\n\tfunction add_checkbox_result(data, type){\n\t\tvar entradas = document.getElementById(type+'-results')\n\t\tentradas.innerHTML = ''\n\t\tfor(d in data){\n\t\t\tvar li = document.createElement('li')\n\t\t\tvar label = document.createElement('label')\n\t\t\tvar input = document.createElement('input')\n\t\t\tinput.type = 'checkbox'\n\t\t\tinput.name = type + '-menu-add[]'\n\t\t\tinput.value = data[d].id\n\t\t\tinput.setAttribute('data-slug', data[d].slug)\n\n\t\t\tvar text = document.createTextNode(' ' + data[d].title)\n\t\t\tlabel.appendChild(input) \t\t\t\t\t\n\t\t\tlabel.appendChild(text)\n\t\t\tli.appendChild(label)\n\t\t\t\n\t\t\tentradas.appendChild(li)\n\t\t\tdocument.querySelector('#add-'+ type+' input[type=submit]').removeAttribute('disabled')\n\t\t\tobjects[type + '_' + data[d].id] = data[d]\n\t\t}\n\t}\n\n\tfunction get_posts(e){\n\t\te.preventDefault()\n\t\tvar t = this\n \t\t$.ajax({\n \t\t\t'url' : this.action,\n \t\t\t'method' : this.method,\n \t\t\t'data' : {\n \t\t\t\t'title' : document.getElementById(this.getAttribute('data-type') + '_title').value,\n \t\t\t\t'type' : this.getAttribute('data-type')\n \t\t\t},\n \t\t\t'headers' : {\n\t            'X-CSRF-TOKEN': $('meta[name=\"csrf-token\"]').attr('content')\n\t        }\n \t\t}).done(function(data, status){\n\t\t\tif (status == 'success') {\n\t\t\t\tif (data.length) {\n\t\t\t\t\tadd_checkbox_result(data, t.getAttribute('data-type'))\n\t\t\t\t} else {\n\n\t\t\t\t\tdocument.querySelector('#add-'+ t.getAttribute('data-type') +' input[type=submit]').setAttribute('disabled','') \t\t\t\t\t\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tconsole.log('error')\n\t\t\t}\n \t\t});\n\t}\n\n  \tfunction add_to_menu(is_link, element, type){\n  \t\tvar li = document.createElement('li')\n  \t\tvar span = document.createElement('span')\n  \t\tvar text = document.createTextNode(' ' + element.title)\n  \t\tvar ul = document.createElement('ul')\n  \t\tli.className = 'ui-state-default'\n  \t\tspan.className = 'ui-icon ui-state-default ui-icon-arrowthick-2-n-s'\n  \t\tul.className = 'connectedSortable'\n\n  \t\tif (!is_link) {\n  \t\t\tli.setAttribute('data-slug', element.slug)\n\t\t\tli.setAttribute('data-id', element.id)\t\n  \t\t} else {\n  \t\t\tli.setAttribute('data-url', element.url)\n  \t\t}\n  \t\tli.id = type+'-'+ new Date().getTime()\n\t\tli.setAttribute('data-title', element.title)\n\t\tli.setAttribute('data-type', type)\n\t\tli.appendChild(span)\n\t\tli.appendChild(text)\n\t\tli.appendChild(ul) \t\t\t\n\n\t\tdocument.getElementById('sortable').appendChild(li)\n\t\t$('.connectedSortable').sortable({\n\t\t\tconnectWith: \".connectedSortable\"\n\t\t});\n\n\t\t$('.ui-state-default').droppable({\n\t\t\tdrop : function( event, ui) {\n\t\t\t\t$('li.ui-state-default').css('border', '0px');\n\t\t\t},\n\t\t\tover : function( event, ui){\n\t\t\t\tthis.style.border = \"1px dashed black\"\n\t\t\t},\n\t\t\tout : function(){\n\t\t\t\tthis.style.border = \"0px\"\n\t\t\t}\n\t \t});\n  \t}\n\n \tfunction add_entrada_to_menu(event){\t\n \t\tevent.preventDefault();\n \t\tvar array = $(this).serializeArray()\n \t\tfor (a in array){\n \t\t\tadd_to_menu(false, objects['post_'+array[a].value], 'post')\n \t\t}\n \t\t\n \t}\n\n \tfunction add_pagina_to_menu(event){\t\n \t\tevent.preventDefault();\n \t\tvar array = $(this).serializeArray()\n \t\tfor (a in array){\n \t\t\tadd_to_menu(false, objects['page_'+array[a].value], 'page')\n \t\t}\n \t\t\n \t}\n\n \tfunction add_categoria_to_menu(event) {\n \t\tevent.preventDefault();\n \t\tvar array = $(this).serializeArray()\n \t\tfor (a in array){\n \t\t\tadd_to_menu(false, objects['category_'+array[a].value], 'category')\n \t\t}\n \t}\n\n \tfunction add_link_to_menu(event) {\n \t\tevent.preventDefault();\n \t\tvar array = { \n \t\t\t'title' : this.elements[0].value,\n \t\t\t'type' : this.getAttribute('data-type'),\n \t\t\t'url' : this.elements[1].value,\n \t\t}\n \t\tadd_to_menu(true, array, 'link')\n \t}\n\n \tfunction build_menu(callback){\n \t\tmenu = new Array()\n \t\tvar array = document.querySelectorAll('#sortable li')\n\n \t\tfor (var a = 0; a < array.length; a++) {\n \t\t\tvar element = {\n \t\t\t\t'id' : array[a].id,\n \t\t\t\t'name' : array[a].getAttribute('data-title'),\n \t\t\t\t'type' : array[a].getAttribute('data-type'),\n \t\t\t\t'order' : (a + 1)\n \t\t\t}\n \t\t\tif (array[a].getAttribute('data-type') == 'link') {\n \t\t\t\telement.url = array[a].getAttribute('data-url')\n \t\t\t}else{\n \t\t\t\telement.entity_id = array[a].getAttribute('data-id')\n \t\t\t}\n \t\t\tvar parent = array[a].parentNode.parentNode\n \t\t\tif (parent.nodeName == 'LI') {\n \t\t\t\telement.parent = parent.id\n \t\t\t} else {\n \t\t\t\telement.parent = ''\n \t\t\t}\n \t\t\tmenu.push(element)\n \t\t}\n \t\tdocument.getElementById('tabs_menu').value = JSON.stringify(menu)\n \t\tcallback()\n \t}\n\n\n \tfunction create_menu(data){\n \t\tconsole.log('create_menu')\n \t\tif (data.length) {\n \t\t\tfor (var i = 0; i < data.length; i++) {\n \t\t\t\tvar li = document.createElement('li')\n\t\t  \t\tvar span = document.createElement('span')\n\t\t  \t\tvar text = document.createTextNode(' ' + data[i].name)\n\t\t  \t\tvar ul = document.createElement('ul')\n\t\t  \t\tli.className = 'ui-state-default'\n\t\t  \t\tspan.className = 'ui-icon ui-state-default ui-icon-arrowthick-2-n-s'\n\t\t  \t\tul.className = 'connectedSortable'\n\n\t\t  \t\tif (data[i].type == 'link') {\n\t\t  \t\t\tli.setAttribute('data-url', data[i].url)\n\t\t  \t\t} else {\n\t\t\t\t\tli.setAttribute('data-id', data[i].entity_id)\t\n\t\t  \t\t}\n\t\t  \t\tli.id = data[i].id\n\t\t\t\tli.setAttribute('data-title', data[i].name)\n\t\t\t\tli.setAttribute('data-type', data[i].type)\n\t\t\t\tli.appendChild(span)\n\t\t\t\tli.appendChild(text)\n\t\t\t\tli.appendChild(ul) \t\n\n\t\t\t\tif (data[i].parent !='') {\n\t\t\t\t\tdocument.querySelector('#'+data[i].parent +' ul').appendChild(li)\n\t\t\t\t} else{\n\t\t\t\t\tdocument.getElementById('sortable').appendChild(li)\n\t\t\t\t}\n \t\t\t}\n\n\t\t\t$('.connectedSortable').sortable({\n\t\t\t\tconnectWith: \".connectedSortable\"\n\t\t\t});\n\n\t\t\t$('.ui-state-default').droppable({\n\t\t\t\tdrop : function( event, ui) {\n\t\t\t\t\t$('li.ui-state-default').css('border', '0px');\n\t\t\t\t},\n\t\t\t\tover : function( event, ui){\n\t\t\t\t\tthis.style.border = \"1px dashed black\"\n\t\t\t\t},\n\t\t\t\tout : function(){\n\t\t\t\t\tthis.style.border = \"0px\"\n\t\t\t\t}\n\t\t \t});\n \t\t}\n \t}\n\n \t$('#add-post').on('submit', add_entrada_to_menu);\n \t$('#add-page').on('submit', add_pagina_to_menu);\n \t$('#add-category').on('submit', add_categoria_to_menu);\n \t$('#add-link').on('submit', add_link_to_menu);\n \t// $('#build').on('click', function(e){\n \t// \te.preventDefault()\n \t// });\n \t$('#submit_menu_form').on('submit', function(e){\n \t\te.preventDefault()\n \t\tvar t = this\n \t\tbuild_menu(function(){t.submit();})\n \t})\n \t$('#post_get_form, #page_get_form, #category_get_form').on('submit', get_posts);\n\n\n \t//EDIT MENU\n \tif(document.getElementsByClassName('editMenu').length){\n \t\tvar url_menu = document.getElementsByClassName('editMenu')[0].getAttribute('data-url')\n \t\t$.get(url_menu, null, create_menu)\n \t}\n})"],"sourceRoot":"/source/"}